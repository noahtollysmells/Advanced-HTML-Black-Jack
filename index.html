<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Blackjack with Currency</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #1e1e1e;
        color: #f0f0f0;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    .table {
        background-color: #2d2d2d;
        border-radius: 15px;
        padding: 20px;
        max-width: 800px;
        margin: 20px auto;
        box-shadow: 0 0 20px rgba(0,0,0,0.8);
        border: 2px solid #0078d7;
    }
    .hand {
        display: flex;
        justify-content: center;
        margin: 10px 0;
    }
    .card {
        width: 60px;
        height: 90px;
        border-radius: 8px;
        background-color: #ffffff;
        color: black;
        margin: 0 5px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 20px;
        font-weight: bold;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    button {
        padding: 10px 20px;
        margin: 5px;
        border: none;
        border-radius: 8px;
        background-color: #0078d7;
        color: white;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.2s;
    }
    button:hover {
        background-color: #005a9e;
    }
    h1, h2, h3 {
        color: #f0f0f0;
    }
    #currency {
        font-size: 18px;
        margin-bottom: 10px;
    }
</style>
</head>
<body>
    <h1>Advanced Blackjack</h1>
    <div id="currency">Balance: £0</div>
    <div class="table">
        <h2>Dealer's Hand: <span id="dealer-score">0</span></h2>
        <div id="dealer-hand" class="hand"></div>
        <h2>Your Hand: <span id="player-score">0</span></h2>
        <div id="player-hand" class="hand"></div>
        <div>
            Bet: £<input type="number" id="bet" value="100" min="10" step="10">
        </div>
        <div>
            <button onclick="deal()">Deal</button>
            <button onclick="hit()">Hit</button>
            <button onclick="stand()">Stand</button>
            <button onclick="doubleDown()">Double</button>
            <button onclick="topUp()">Top Up £500</button>
        </div>
        <h3 id="message"></h3>
    </div>
<script>
let deck = [];
let playerHand = [];
let dealerHand = [];
let playerScore = 0;
let dealerScore = 0;
let canPlay = false;
let balance = parseInt(localStorage.getItem('balance')) || 1000;

function updateCurrencyDisplay() {
    document.getElementById('currency').textContent = `Balance: £${balance}`;
    localStorage.setItem('balance', balance);
}

function createDeck() {
    const suits = ['♠', '♥', '♦', '♣'];
    const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
    deck = [];
    for (let suit of suits) {
        for (let value of values) {
            deck.push({value, suit});
        }
    }
    deck.sort(() => Math.random() - 0.5);
}

function calculateScore(hand) {
    let score = 0;
    let aces = 0;
    for (let card of hand) {
        if (['J', 'Q', 'K'].includes(card.value)) {
            score += 10;
        } else if (card.value === 'A') {
            score += 11;
            aces++;
        } else {
            score += parseInt(card.value);
        }
    }
    while (score > 21 && aces) {
        score -= 10;
        aces--;
    }
    return score;
}

function renderHand(hand, elementId) {
    const container = document.getElementById(elementId);
    container.innerHTML = '';
    for (let card of hand) {
        const cardDiv = document.createElement('div');
        cardDiv.classList.add('card');
        cardDiv.textContent = card.value + card.suit;
        container.appendChild(cardDiv);
    }
}

function deal() {
    let bet = parseInt(document.getElementById('bet').value);
    if (bet > balance || bet <= 0) {
        alert('Invalid bet amount');
        return;
    }
    createDeck();
    playerHand = [deck.pop(), deck.pop()];
    dealerHand = [deck.pop(), deck.pop()];
    canPlay = true;
    updateScores();
    renderHands();
    document.getElementById('message').textContent = '';
}

function hit() {
    if (!canPlay) return;
    playerHand.push(deck.pop());
    updateScores();
    renderHands();
    if (playerScore > 21) {
        adjustBalance(-getBet());
        endGame('Bust! Dealer Wins.');
    }
}

function stand() {
    if (!canPlay) return;
    while (dealerScore < 17) {
        dealerHand.push(deck.pop());
        updateScores();
    }
    if (dealerScore > 21 || playerScore > dealerScore) {
        adjustBalance(getBet());
        endGame('You Win!');
    } else if (dealerScore === playerScore) {
        endGame('Push!');
    } else {
        adjustBalance(-getBet());
        endGame('Dealer Wins!');
    }
}

function doubleDown() {
    if (!canPlay) return;
    playerHand.push(deck.pop());
    updateScores();
    if (playerScore <= 21) {
        let doubleBet = getBet() * 2;
        if (dealerScore < 17) {
            while (dealerScore < 17) {
                dealerHand.push(deck.pop());
                updateScores();
            }
        }
        if (dealerScore > 21 || playerScore > dealerScore) {
            adjustBalance(doubleBet);
            endGame('You Win (Double Down)!');
        } else if (dealerScore === playerScore) {
            endGame('Push!');
        } else {
            adjustBalance(-doubleBet);
            endGame('Dealer Wins!');
        }
    } else {
        adjustBalance(-getBet() * 2);
        endGame('Bust! Dealer Wins.');
    }
}

function getBet() {
    return parseInt(document.getElementById('bet').value);
}

function adjustBalance(amount) {
    balance += amount;
    updateCurrencyDisplay();
}

function topUp() {
    balance += 500;
    updateCurrencyDisplay();
}

function updateScores() {
    playerScore = calculateScore(playerHand);
    dealerScore = calculateScore(dealerHand);
    document.getElementById('player-score').textContent = playerScore;
    document.getElementById('dealer-score').textContent = dealerScore;
}

function renderHands() {
    renderHand(playerHand, 'player-hand');
    renderHand(dealerHand, 'dealer-hand');
}

function endGame(message) {
    canPlay = false;
    document.getElementById('message').textContent = message;
}

updateCurrencyDisplay();
</script>
</body>
</html>
